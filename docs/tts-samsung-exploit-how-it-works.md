# 这个 2019 年的漏洞仍然可以危及三星的最新旗舰

> 原文：<https://www.xda-developers.com/tts-samsung-exploit-how-it-works/>

智能手机是我们许多生活的核心。我们与所爱的人交谈，计划我们的日子，并通过他们组织我们的生活。它们是一种工具，可以说是我们自身的延伸，这就是移动安全如此重要的原因。这就是为什么当像 XDA 高级成员[k0 raid 3](https://forum.xda-developers.com/m/k0mraid3.11993791/)的漏洞出现并授予用户几乎任何*三星智能手机的完全系统访问权时，这是一件大事。*

当然，这些东西在喜欢修改和玩智能手机的最终用户手中也有好处。更大的系统访问权限允许用户做像[启动 GSI](https://www.xda-developers.com/dsu-sideloader-boot-custom-android-gsi/) 或改变他们设备的 CSC 这样的事情。但是，因为这授予用户 1000 的 UID(这是系统的访问权限)，所以它也可以以危险的方式使用。它绕过所有权限检查，可以访问所有应用程序组件，发送受保护的广播，在后台启动活动，等等。

如果你想试试这个漏洞，看看你能在你的系统中改变什么，我们有一个[教程告诉你怎么做。如果您对这种利用背后的历史以及它是如何工作的感兴趣，那么请继续阅读。我们采访了 K0mraid3，问他它是如何工作的，他从头到尾向我们讲述了 2019 年的这一漏洞如何影响每一部三星智能手机，包括 2022 年的旗舰手机。](https://www.xda-developers.com/samsung-galaxy-system-shell-access-how-to/)

## 三星的文本到语音(TTS)应用程序是这个问题的源头

早在 2019 年，据报道，3.0.02.7 之前版本的 CVE CVE-2019-16253 漏洞影响了三星的 TTS 引擎。此漏洞允许本地攻击者将权限提升为系统权限，后来得到了修补和修复。

本质上，三星的 TTS 应用程序会盲目地接受它从 TTS 引擎收到的任何数据。您可以向 TTS 引擎传递一个库，这个库将被提供给 TTS 应用程序，然后应用程序将加载这个库并以系统权限执行它。这一点后来被修补，以便 TTS 应用程序可以验证来自引擎的数据，从而堵塞这个特殊的漏洞。

然而，在 Android 10 中，Google 引入了通过使用 ENABLE_ROLLBACK 参数安装应用程序来回滚应用程序的功能。这允许用户将安装在设备上的应用程序版本恢复到安装在设备上的应用程序的**先前**版本。Komraid3 表示，他认为一个“疏忽”使得这一功能扩展到了三星目前在任何三星设备上的文本到语音转换应用程序，因为用户可以在新款三星手机上降级到的旧版 TTS 应用程序此前从未安装在这些手机上。

**(更新时间:01/24/23 @ 15:05)** 这个错误的原因实际上似乎是因为在安装旧的 TTS 应用程序时在 adb 命令中添加了'-d '标志。它应该只适用于可调试的应用程序，但它也适用于不可调试的应用程序[根据](https://blog.esper.io/adb-29-how-to-downgrade-rollback-app/) *[【斯珀】](https://blog.esper.io/adb-29-how-to-downgrade-rollback-app/)，*这就是为什么 TTS 应用程序可以被强制降级。

换句话说，尽管 2019 年的漏洞已被修复，TTS 应用程序的更新版本也已发布，但用户在三年(或许四年)后发布的设备上安装和利用它是微不足道的。

## 三星自 2022 年 10 月以来就知道了这个问题

这种特殊利用最可怕的不是它授予的访问级别，而是三星知道 2022 年 10 月 7 日的事实。K0mraid3 告诉我，他在 1 月份再次联系三星，以跟进并了解发生了什么事情，但被告知这是 AOSP 的问题，并提交了一份谷歌官方报告。有趣的是，三星还表示，该问题已在谷歌 Pixel 智能手机上得到证实。

 <picture>![SamsungExploitGoogleEmailSamsungKomraid3](img/b9f19b8748c885cd4b74aa8c38da6718.png)</picture> 

Email sent to K0mraid3 from Samsung.

三星发给 K0mraid3 的邮件。

K0mraid3 去跟 Google 举报，发现三星*和*另一个调研都已经跟 Google 举报了。另一位研究人员在三星之后不久报告了这一情况。我们目前无法访问这些错误报告，因为它们在谷歌的问题跟踪器上被标记为私有。K0mraid3 分享了来自谷歌和三星的邮件，证实了这些 bug 报告的存在。

如果这确实是 AOSP 的问题，还不清楚谷歌将如何解决这个问题。

## 用户可以做些什么来保护自己？

正如 K0mraid3 在他的 [XDA 论坛帖子](https://forum.xda-developers.com/t/system-shell-exploit-all-samsung-mobile-devices-no-bl-unlock-required.4543071/)中所说，用户保护自己的最佳方式是自己设置并使用这个漏洞。一旦这样做了，其他用户就不能将第二个库加载到 TTS 引擎中。或者，您也可以禁用或移除 Samsung TTS。

目前，还不清楚这是否会影响 2023 年发布的设备，我们很好奇它是否会影响即将发布的[三星 Galaxy S23](https://xda-developers.com/samsung-galaxy-s23) 系列。此外，K0mraid3 提到一些联合开发制造(JDM)设备(如三星 Galaxy A03)可能会有问题。他们可能只需要一个来自旧 JDM 设备的正确签名的 TTS 应用程序，但目前还不清楚。

我们已经联系了谷歌和三星进行评论，如果有回音，我们一定会更新这篇文章。

*感谢 XDA 资深会员 K0mraid3 对本文的宝贵投入！*