# 每月 Android 安全补丁更新如何工作

> 原文：<https://www.xda-developers.com/how-android-security-patch-updates-work/>

自 2015 年 8 月以来，谷歌一直在发布每月安全公告。这些安全公告包含已修复的已披露安全漏洞列表，这些漏洞会影响 Android 框架、Linux 内核和其他闭源供应商组件。公告中的每个漏洞要么是谷歌发现的，要么是[向公司](https://g.co/AndroidSecurityReport)披露的。列出的每个漏洞都有一个通用漏洞和披露(CVE)编号，以及相关参考、漏洞类型、严重性评估和受影响的 AOSP 版本(如果适用)。尽管 Android 安全补丁的工作过程看似简单，但实际上在幕后有一个有点复杂的来回过程，允许你的手机每月或(希望)几乎每月获得补丁。

## 究竟是什么构成了安全补丁？

你可能已经注意到，每个月，实际上都有*两个*安全补丁级别。这些修补程序的格式是 YYYY-MM-01 或 YYYY-MM-05。虽然 YYYY 和 MM 显然分别代表年和月，但是“01”和“05”实际上并不表示发布该安全补丁级别的日期。相反，01 和 05 实际上是每月同一天发布的两个不同的安全补丁级别——以 01 结尾的补丁级别包含对 Android 框架的修复，但**没有**供应商补丁或上游 Linux 内核补丁。正如我们上面定义的，厂商补丁指的是对封闭源代码组件的修复，如 Wi-Fi 和蓝牙的驱动程序。由-05 表示的安全修补程序级别包含这些供应商修补程序以及 Linux 内核中的修补程序。请看下表，这可能有助于理解。

| 

每月安全补丁级别

 | 

2019-04-01

 | 

2019-04-05

 |
| --- | --- | --- |
| 包含四月框架补丁 | 是 | 是 |
| 包含 4 月供应商+内核补丁 | 不 | 是 |
| 包含 March 框架补丁 | 是 | 是 |
| 包含三月供应商+内核补丁 | 是 | 是 |

当然，一些原始设备制造商也可能选择将他们自己的补丁和更新加入安全更新中。大多数原始设备制造商对 Android 都有自己的看法，因此，举例来说，你可能在三星手机上有一个华为手机上不存在的漏洞，这才有意义。许多原始设备制造商也发布他们自己的安全公告。

## 从谷歌到你手机的安全补丁的时间表

安全补丁有一个大约 30 天的时间表，尽管不是每个 OEM 都能利用这个时间表的全部长度。让我们来看看【2019 年 5 月的安全补丁例如，我们可以分解这个补丁创建背后的整个时间表。像 [Essential](https://www.xda-developers.com/essential-shut-down-no-more-updates/) 这样的公司设法在谷歌 Pixel 发布的同一天发布他们的安全更新**，那么他们是怎么做到的呢？简单明了的答案是，他们是一个 [**安卓伙伴**](https://www.android.com/certified/partners/) 。2019 年 5 月的安全公告[于 5 月 6 日](https://www.xda-developers.com/may-2019-google-android-security-updates/)发布，谷歌像素和基本手机都获得了近乎即时的更新。**

### 成为 Android 合作伙伴意味着什么

不是任何公司都可以成为 Android 的合作伙伴，尽管不可否认的是，基本上每个主要的 Android OEM 都是。Android 合作伙伴是被授权在营销材料中使用 Android 品牌的公司。他们还被允许提供谷歌移动服务(GMS——指几乎所有的谷歌服务),只要他们满足兼容性定义文件(CDD)中概述的要求，并通过兼容性测试套件(CTS)、供应商测试套件(VTS)、谷歌测试套件(GTS)和其他一些测试。对于不是安卓合作伙伴的公司来说，安全补丁程序有明显的不同。

*   在安全公告发布前 1-2 天，Android 框架补丁在被合并到 AOSP 后对他们可用。
*   上游的 Linux 内核补丁一旦可用，就可以进行精选。
*   根据与 SoC 供应商的协议，可以从 SoC 供应商处获得闭源组件的修复程序。请注意，如果供应商允许 OEM 访问闭源组件的源代码，那么 OEM 可以自己解决问题。如果 OEM 无法访问源代码，那么他们必须等待供应商发布修复程序。

如果你是一个 Android 的合作伙伴，你马上就会轻松很多。在公告公开前至少 30 天，Android 合作伙伴会收到所有 Android 框架问题和 Linux 内核问题的通知。Google 为 OEM 提供所有问题的补丁来合并和测试，尽管供应商组件补丁依赖于供应商。例如，2019 年 5 月安全公告中披露的 Android 框架问题的补丁至少早在 2019 年 3 月 20 日*就已提供给 Android 合作伙伴。那是很多额外的时间。

*注意:Google 可以，也经常，更新最新安全公告的补丁，直到公开发布。如果发现了新的漏洞和错误，如果 Google 由于破坏了关键组件而决定从每月公告中删除某些补丁，如果 Google 更新补丁以解决以前版本的补丁造成的错误，以及其他原因，这些更新都可能发生。

### 为什么我需要等很久才能在手机上收到安全补丁？

虽然 Android 合作伙伴(即所有主要 OEM 厂商)确实在发布之前就收到了安全补丁，但许多人痛苦地意识到，他们可能在发布后的几个月内都不会收到安全更新。这通常归结为四个原因之一。

*   原始设备制造商可能需要进行重大的技术修改，以适应安全补丁，因为它可能与现有的代码冲突。
*   供应商在为闭源组件提供更新源代码方面动作缓慢。
*   运营商认证可能需要时间。
*   公司可能不愿意在发布安全更新的同时不发布某个功能。

虽然所有这些都是企业不发布安全补丁的正当理由，但最终用户并不总是关心这些。诚然，最终用户也不总是关心安全补丁，尽管他们应该关心。像 Project Treble、 [extended Linux LTS](https://www.xda-developers.com/linux-kernel-long-term-support-google/) 和[项目主线](https://www.xda-developers.com/android-q-project-mainline-security/)这样的计划有助于消除合并这些安全补丁的技术困难，但这还不足以让原始设备制造商坚持不懈地努力发布更新。有了通用内核映像或 GKI，SoC 供应商和原始设备制造商将更容易合并上游 Linux 内核补丁，尽管我们可能要到明年才能看到第一批带有 GKI 的设备。

但是大多数人不知道的一个有趣的信息是，主要的原始设备制造商**必须**在设备发布后的一年内提供“至少四次安全更新”,总共两年的更新。谷歌尚未证实这些具体条款，但该公司证实，他们“致力于将安全补丁纳入(他们的)OEM 协议”。至于 Android 企业推荐(AER)设备，要求设备在 3 年内发布 90 天内获得安全更新。坚固的 AER 设备需要获得 [**5 年**](https://www.xda-developers.com/rugged-devices-android-enterprise-recommended-5-years-security-updates/) [的安全更新](https://www.xda-developers.com/rugged-devices-android-enterprise-recommended-5-years-security-updates/)。Android One 设备应该在 3 年内每月进行安全更新。

## 安全补丁里有什么？

安全补丁只是另一种更新，虽然通常是对单个框架和系统模块的更改，而不是系统范围的改进或更改。每个月，谷歌都会向设备原始设备制造商提供一个 zip 文件，其中包含目前仍受支持的所有主要 Android 版本的补丁，以及一个安全测试套件。这个测试套件帮助 OEM 抓住安全补丁中的漏洞，[以确保他们不会遗漏任何东西](https://www.xda-developers.com/android-oem-lying-security-patches/)并且补丁被适当地合并。随着这个月的推移，谷歌可能会做出一些小的修改，比如决定某个特定的补丁是可选的，特别是在实现它有困难的时候。

## 定制 rom 呢？

如果你的智能手机没有得到很多安全更新，这并不一定意味着你最好换成定制的 ROM。虽然您将获得通过其他方式无法获得的安全更新，但这只是故事的一半。解锁您的引导加载程序会使您的设备容易受到物理攻击，即使在软件方面，安全性得到了加强。这并不是说你不应该使用定制的 rom，只是在使用它们的时候，如果你的引导程序被锁定，还有其他的问题不适用。如果你更担心软件方面的事情，那么你最好还是用一个定制的 ROM，它可以经常得到安全补丁。

但是还记得我们说过 YYYY-MM-01 和 YYYY-MM-05 补丁的区别吗？-05 补丁级别包含 Linux 内核补丁和供应商补丁——应用于闭源软件的补丁。这意味着定制 ROM 开发者受到他们开发的任何 OEM 的支配，以及 OEM 是否发布更新的 blobs。这对于仍然由制造商更新的设备来说没问题，但对于没有更新的设备来说，应用的补丁只能应用于 Android 框架和 Linux 内核。这就是为什么 LineageOS 的[信任接口](https://www.xda-developers.com/lineageos-trust-centralized-interface-security-privacy/)显示两个安全补丁级别——一个是平台，另一个是厂商。尽管为不受支持的设备定制的 ROM 不能完全集成所有最新的补丁，但它们将比旧的、过时的 ROM 更安全。