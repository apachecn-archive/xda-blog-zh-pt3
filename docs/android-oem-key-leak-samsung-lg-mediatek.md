# Android OEM 密钥泄露意味着侧装“更新”可能隐藏着严重的恶意软件

> 原文：<https://www.xda-developers.com/android-oem-key-leak-samsung-lg-mediatek/>

Android 智能手机安全性的一个重要方面是应用程序签名过程。这本质上是一种保证任何应用程序更新都来自原始开发者的方式，因为用于签署应用程序的密钥应该始终保持私有。三星、联发科、LG 和 Revoview 等公司的许多平台证书似乎已经泄露，更糟糕的是，这些证书被用于签署恶意软件。这是通过 Android 合作伙伴漏洞倡议(APVI)披露的，只适用于应用程序更新，而不是在线旅行社。

当签名密钥泄露时，理论上，攻击者可以用签名密钥签署恶意应用程序，并将其作为某人手机上应用程序的“更新”分发。一个人所需要做的就是从第三方网站下载一个更新，对于发烧友来说，这是一个相当常见的体验。在这种情况下，用户将在不知不觉中授予 android 操作系统级别的恶意软件访问权限，因为这些恶意应用程序可以利用 Android 的共享 UID 和与“Android”系统进程的接口。

平台证书是用于对系统映像上的“android”应用程序进行签名的应用程序签名证书。“android”应用程序使用高特权用户 id——Android . uid . system——运行，并拥有系统权限，包括访问用户数据的权限。任何其他使用相同证书签名的应用程序都可以声明它希望使用相同的用户 id 运行，从而获得对 Android 操作系统的相同级别的访问权限，”《APVI》的记者解释道。这些证书是特定于供应商的，因为三星设备上的证书将不同于 LG 设备上的证书，即使它们用于签署“android”应用程序。

这些恶意软件样本是由谷歌的逆向工程师 ukasz Siewierski 发现的。Siewierski 分享了每个恶意软件样本的 SHA256 哈希及其签名证书，我们可以在 VirusTotal 上查看这些样本。尚不清楚这些样本是在哪里发现的，也不清楚它们之前是否在谷歌 Play 商店、APK 的分享网站(如 APKMirror)或其他地方分发过。用这些平台证书签名的恶意软件的包名列表如下。更新:谷歌称这种恶意软件不是在谷歌 Play 商店上检测到的。

*   com vantage . electronic . corn muni
*   俄罗斯官方网站
*   com.sledsdffsjkh.Search
*   com.android.power
*   com .管理.宣传
*   com.sec.android.musicplayer
*   com.houla.quicken
*   com.attd.da
*   com.arlo.fappx
*   com.metasploit.stage

在报告中，它指出，“所有受影响的各方都被告知调查结果，并已采取补救措施，以最大限度地减少对用户的影响。”不过，至少在三星的情况下，这些证书似乎还在使用。[在 APKMirror](https://www.apkmirror.com/?post_type=app_release&searchtype=apk&s=34df0e7a9f1cf1892e45c056b4973cd81ccf148a4050d11aea4ac5a65f900a42) 上搜索其泄露的证书，显示甚至今天的更新都与这些泄露的签名密钥一起分发。

令人担忧的是，其中一个签署了三星证书的恶意软件样本是在 2016 年首次提交的。目前还不清楚三星的证书是否因此在六年里一直处于恶意之手。目前更不清楚的是*这些证书是如何在野外流传的，以及是否已经造成了任何损害。人们一直在下载应用程序更新，并依赖证书签名系统来确保这些应用程序更新是合法的。*

至于公司能做什么，最好的办法是关键的轮换。 [Android 的 APK 签名方案 v3 原生支持密钥轮换](https://www.xda-developers.com/apk-signature-scheme-v3-key-rotation/)，开发者可以从签名方案 v2 升级到 v3。

APVI 上的记者给出的建议动作是“所有受影响方应该通过用一组新的公钥和私钥替换它来轮换平台证书。此外，他们应该进行内部调查，找出问题的根本原因，并采取措施防止将来再次发生此类事件。”

“我们还强烈建议尽量减少用平台证书签名的应用程序的数量，因为如果将来发生类似的事件，这将大大降低轮换平台密钥的成本，”它总结道。

当我们联系三星时，公司发言人给了我们以下回应。

> 三星非常重视 Galaxy 设备的安全性。我们自 2016 年意识到这一问题后就发布了安全补丁，目前还没有关于这一潜在漏洞的已知安全事件。我们始终建议用户用最新的软件更新来保持他们的设备最新。

上述回应似乎证实了该公司自 2016 年以来就知道这一泄露的证书，尽管它声称没有已知的关于该漏洞的安全事件。然而，目前还不清楚它还做了什么来消除该漏洞，鉴于该恶意软件于 2016 年首次提交给 VirusTotal，它似乎肯定在某个地方逍遥法外。

我们已经联系了联发科和谷歌进行评论，当我们得到回复时，我们将向您更新。

### 更新:美国东部时间 2022/12/02 12:45 亚当·康威

***谷歌回应***

谷歌给了我们以下声明。

> 我们一报告关键的妥协，OEM 合作伙伴就立即实施了缓解措施。最终用户将受到 OEM 合作伙伴实施的用户缓解措施的保护。谷歌在构建测试套件中对恶意软件实施了广泛的检测，该套件扫描系统映像。Google Play Protect 还可以检测恶意软件。没有迹象表明该恶意软件现在或曾经在谷歌 Play 商店上。一如既往，我们建议用户确保他们运行的是最新版本的 Android。