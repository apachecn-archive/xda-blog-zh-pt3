<html>
<head>
<title>Ambient Music Mod v2 Hands-on: Google Pixel’s Now Playing feature port</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">环境音乐Mod v2实践:谷歌像素的现在播放功能端口</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/google-pixel-now-playing-ambient-music-mod-v2-hands-on/#0001-01-01">https://www.xda-developers.com/google-pixel-now-playing-ambient-music-mod-v2-hands-on/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p class="translated">大多数人都会同意，Pixel智能手机上的软件展示了谷歌认为Android <em>应该是</em>的样子，因此，该软件经常受到发烧友的欢迎。尽管如此，由于专门的修改社区，你不一定要拥有一个像素设备来利用其软件功能。例如，“正在播放”功能仍然是Pixel系列的专属功能，但开发者Kieron Quinn，在我们的论坛上也被称为<a href="https://forum.xda-developers.com/m/quinny899.3563640/"> Quinny899 </a>，成功地将它以混合Xposed-Magisk模块的形式<a href="https://www.xda-developers.com/google-pixel-now-playing-feature-ported/">移植到其他Android智能手机</a>，该模块被命名为<strong>环境音乐模块</strong>。现在，奎因更进一步，彻底改革了mod，使其成为一个非根解决方案。</p>

 
<h2 id="meet-ambient-music-mod-v2" class="translated">满足环境音乐模式v2</h2>
<p class="translated">在没有root权限的情况下，让Pixel智能手机的<a href="https://support.google.com/pixelphone/answer/7535326">环境音乐识别功能与硬件无关并不是一件容易的事情，但Quinny899使用滴实现了这一壮举。不知情的是，滴使用了一种独特的服务，即</a><a href="https://www.xda-developers.com/implementing-shizuku/">允许第三方应用程序通过Android调试桥(ADB)接口访问系统级API</a>。自v2发布以来，环境音乐模式可以在运行Android 12或更高版本的设备上无需root访问即可工作<strong>。</strong></p>

<p class="translated">另一个大的变化是移除了与Xposed相关的依赖项。不再需要安装像<a href="https://www.xda-developers.com/edxposed/"> EdXposed </a>或<a href="https://www.xda-developers.com/lsposed/"> LSPosed </a>这样的Xposed发行版，因为mod现在是一个独立的应用程序。请记住，你仍然可以在旧的Android版本上选择环境音乐模式的根版本。</p>
<p class="ad-odd">
</p>


<h2 id="what-are-the-features-of-ambient-music-mod-v2" class="translated">环境音乐Mod v2有什么特点</h2>
<p class="translated">以下是环境音乐模式提供的功能概要:</p>

<ul> <li class="translated">完全支持现在播放，基于Pixel设备的最新版本和最新的音乐数据库</li> <li class="translated">自动环境音乐识别，通过设置控制识别运行的频率-在电池使用和便利性之间找到正确的平衡</li> <li class="translated">现在播放历史和收藏夹支持</li> <li class="translated">支持手动触发识别，包括一个主屏幕部件</li> <li class="translated">在支持的设备上进行点播识别，对不在本地数据库中的歌曲使用Google Assistant支持的识别引擎(必须手动触发)</li> <li class="translated">在锁定屏幕上显示正在播放的歌曲(需要辅助功能服务)</li> <li class="translated">查看可识别歌曲的完整曲目列表，如果您的喜好与设备的区域设置不匹配，请更改数据库位置</li> </ul>

<p class="translated">在撰写本文时，开发人员已经在v2主版本之后推出了两个修补程序。现在，您可以选择替代编码选项并微调“增益”值，以修复失真和/或劈啪声问题。</p>
<p class="ad-even">
</p>


<h2 id="how-to-download-and-install-ambient-music-mod-v2" class="translated">如何下载和安装环境音乐Mod v2</h2>
<p class="translated">就像最初的版本一样，环境音乐Mod v2是一个免费的开源Mod。你可以在下面链接的项目GitHub repo上找到APK的最新版本。</p>

<p/><p class="translated"><strong> <a href="https://github.com/KieronQuinn/AmbientMusicMod/releases/latest">下载环境音乐模式</a> </strong></p>

<p class="translated">要安装下载的APK，看一下<a href="https://www.xda-developers.com/how-to-sideload-install-android-app-apk/">我们的侧装安卓应用包指南</a>。安装后，环境音乐模块将要求滴访问。根据底层Android版本，您可以继续使用root或非root模式。接下来，该应用程序将下载一些额外的组件，并提示您给予所需的权限——仅此而已。</p>




<p class="ad-odd">
</p>


<h2 id="comparing-google-s-now-playing-and-ambient-music-mod-v2" class="translated">比较Google的Now Playing和Ambient Music Mod v2</h2>
<p class="translated">在引擎盖下，Ambient Music Mod使用了一款名为Android System Intelligence 的谷歌应用的<a href="https://github.com/KieronQuinn/NowPlaying">修改版。设备上识别部分是在查询音乐数据库后执行的——这正是谷歌现在播放的内容。因此，Ambient Music Mod在非谷歌设备上的真实表现或多或少类似于Pixel智能手机——尤其是在调整参数之后。然而，像素专属功能和mod之间有一些不同之处。</a></p>

<p class="translated">这里有一个快速的实践来展示Google官方实现和Quinny899的mod之间的区别。测试设备是运行Android 13 Beta 3.2的谷歌Pixel 4a和运行Android 11之上的LineageOS 18.1非官方版本的Redmi 5。</p>

<h3 id="ui" class="translated">1.用户界面</h3>
<p class="translated">在Pixel智能手机上，可以访问<em>设置</em> = &gt; <em>声音&amp;振动</em>下的“正在播放”选项。然而，环境音乐模式是一个独立的应用程序，因此你可以在你的启动器的应用程序列表部分找到它的条目。点击图标后，您可以访问<em>正在播放</em>屏幕和其他选项。</p>





<h3 id="recognizing-the-ambient-music" class="translated">2.识别环境音乐</h3>
<p class="translated">一旦下载了音乐数据库，您应该能够为两者打开名为“识别附近播放的歌曲”的选项。在谷歌Pixel设备上，你周围播放的歌曲应该会被自动识别并显示在锁定屏幕上。</p>



<p class="translated">另一方面，环境音乐模式允许你切换这个选项。如果你不想弄乱你的锁屏，你可以选择手动“识别”按钮来识别音乐。</p>





<h3 id="now-playing-history-and-music-search" class="translated">3.现在播放历史和音乐搜索</h3>
<p class="translated"><em>现在播放历史</em>部分在两个实现中实际上是相同的。您可以探索已识别音乐的历史，将它们添加到<em>收藏夹</em>列表中，并可选择将该部分的快捷方式放在您的主屏幕上以便快速访问。</p>





<p class="translated">然而，手动搜索部分是不同的。在Pixel手机上，你只需打开名为<em>在锁屏上显示搜索按钮</em>的选项，就可以在锁屏上搜索歌曲。这种“按需”识别机制可能无法在所有开箱即用的设备上使用环境音乐模式。欲知详情，敬请<a href="https://github.com/KieronQuinn/AmbientMusicMod/wiki/Enabling-On-Demand">浏览开发者</a>的解释。</p>





<h3 id="miscellaneous" class="translated">4.多方面的</h3>
<p class="translated">由于谷歌的Now Playing模块是Pixel固件的内置组件，因此没有太多需要修改的地方。为了推广它，Quinny899必须在环境音乐Mod代码库中放置一些自定义参数。</p>



<p class="translated">您可以调整音乐识别周期和缓冲区，强制识别例程在小CPU内核上运行，调整增益，等等。这是大大提高兼容性的东西。例如，我必须在Redmi 5上选择备用编码(从v2.0.2版本开始可用)，否则，它将因失真而无法检测环境音乐。mod还允许你备份你的自定义设置，并在以后恢复它们。</p>
<p class="ad-even">
</p>


<h2 id="conclusion" class="translated">结论</h2>
<p class="translated">Now Playing功能从未在AOSP推出过，所以Kieron不得不进行逆向工程，并经历了大量的挑战，以使其适用于非谷歌设备。何<a href="https://medium.com/@KieronQuinn/now-playing-ambient-music-mod-v2-93cd4042cc11">在他的博客里详细描述了这个过程</a>。如果你想了解幕后的一切，不妨读一读。</p>

<p class="translated">前往GitHub链接获取代码库和更多关于mod如何工作的信息。你也可以参与讨论，报告错误，或者通过在下面链接的论坛帖子中发帖来请求新功能。</p>

<p/><p class="translated"><strong>环境音乐Mod:<a href="https://github.com/KieronQuinn/AmbientMusicMod">GitHub Repo</a>| |<a href="https://forum.xda-developers.com/t/4260761/">XDA讨论线程</a> </strong></p>

<hr/>

<p class="translated"><strong>来源:</strong> <a href="https://twitter.com/MishaalRahman/status/1538628853949779969">米沙·拉赫曼在推特上</a></p>

 </div>


</div>    
</body>
</html>